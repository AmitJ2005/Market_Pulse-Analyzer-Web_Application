<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='result.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment"></script>
    <style>
       /* CSS styles for the header */
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width:99%;
    height:50px;
    padding: 2px;
    border-radius: 10px;
    background-color: rgba(14, 26, 53, 0.85); /* 15% transparent */
}

#navigation ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
}

#navigation ul li {
    display: inline;
    margin-right: 20px;
}

#searchContainer {
    display: flex;
    align-items: center;
    border-radius: 10px; /* Rounded corners */
    background-color: white; /* White background */
    padding: 5px; /* Adjust padding */
}

#searchInput {
    padding: 5px;
    margin-right: 10px;
    border: none; /* Remove border */
    outline: none; /* Remove outline */
    border-radius: 20px; /* Rounded corners */
}

#cancelButton {
    cursor: pointer;
    color:red;
}

#cancelButton:hover {
    color: red; /* Change color on hover */
}


    </style>
</head>
<body>
    <header>

        <div id="navigation">
            <ul>
                <li><a href="/">Home</a></li>
            </ul>
        </div>
        <div id="searchContainer">
            <input type="text" id="searchInput" placeholder="Enter stock name">
            <div id="cancelButton">&#10006;</div>
            <ul id="suggestionList"></ul>
        </div>
    </header>



    <!-- First Visualization: Line Chart -->
    <div class="chart-container">
        <canvas id="dailyChart" width="400" height="100"></canvas>
    </div>



    <!-- Second Visualization: Bar Chart for Monthly Data -->
    <div class="chart-container">
        <select id="monthSelect">
            <option value="1">January</option>
            <option value="2">February</option>
            <option value="3">March</option>
            <option value="4">April</option>
            <option value="5">May</option>
            <option value="6">June</option>
            <option value="7">July</option>
            <option value="8">August</option>
            <option value="9">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
        </select>
        <canvas id="monthlyChart" width="400" height="100"></canvas>
    </div>



    <!-- Third Visualization: Bar Chart for Yearly Data -->
    <div class="chart-container">
        <canvas id="yearlyChart" width="400" height="100"></canvas>
    </div>



    <script>
   // First Visualization: Line Chart
var dailyLabels = {{ labels | safe }};
var dailyData = {{ data | safe }};
var dailyCtx = document.getElementById('dailyChart').getContext('2d');
var dailyChart = new Chart(dailyCtx, {
    type: 'line',
    data: {
        labels: dailyLabels,
        datasets: [{
            label: 'Stock Prices Over Time',
            data: dailyData,
            borderColor: 'rgb(75, 192, 192)',
            tension: 0.1,
            fill: false,
            pointRadius: 0,
        }]
    },
    options: {
        animation: {
            duration: 3000,
        },
        scales: {
            x: {
                type: 'time',
                time: {
                    unit: 'year',
                    tooltipFormat: 'YYYY',
                    displayFormats: {
                        year: 'YYYY'
                    }
                },
                grid: {
                    display: false
                }
            },
            y: {
                beginAtZero: false,
                position: 'right',
                grid: {
                    display: true
                }
            }
        }
    }
});

// Second Visualization: Bar Chart for Monthly Data
var monthlyData = {{ data_monthly|tojson|safe }};
var monthlyCtx = document.getElementById('monthlyChart').getContext('2d');
var monthlyChart = new Chart(monthlyCtx, {
    type: 'bar',
    data: {
        labels: [],
        datasets: [{
            label: 'Returns',
            data: [],
            backgroundColor: []
        }]
    },
    options: {
        animation: {
            duration: 3000
        },
        scales: {
            x:{
                grid: {
                    display: false
                }
            },
        }
    }
});

document.getElementById('monthSelect').addEventListener('change', function() {
    var month = this.value;
    var filteredData = monthlyData.filter(function(item) {
        return item.Month == month;
    });
    monthlyChart.data.labels = filteredData.map(function(item) {
        return item.Year;
    });
    monthlyChart.data.datasets[0].data = filteredData.map(function(item) {
        return item.Returns;
    });
    monthlyChart.data.datasets[0].backgroundColor = filteredData.map(function(item) {
        return item.Returns >= 0 ? 'green' : 'red';
    });
    monthlyChart.update();
});
document.getElementById('monthSelect').dispatchEvent(new Event('change'));

// Third Visualization: Bar Chart for Yearly Data
var yearlyData = {{ data_yearly|tojson|safe }};
var yearlyCtx = document.getElementById('yearlyChart').getContext('2d');
var yearlyChart = new Chart(yearlyCtx, {
    type: 'bar',
    data: {
        labels: yearlyData.map(function(item) { return item.Year; }),
        datasets: [{
            label: 'Returns',
            data: yearlyData.map(function(item) { return parseFloat(item.Returns); }),
            backgroundColor: yearlyData.map(function(item) { return item.Direction == 'Positive' ? 'green' : 'red'; })
        }]
    },
    options: {
        animation: {
            duration: 3000
        },
        scales: {
            x:{
                grid: {
                    display: false
                }
            },
            y: {
                beginAtZero: true
            }
        }
    }
});

    </script>
<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
